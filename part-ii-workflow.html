<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>EPINOR Annual Meeting 2021</title>
    <meta charset="utf-8" />
    <meta name="author" content="Øystein Sørensen" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# EPINOR Annual Meeting 2021
## A Gentle Introduction to Bayesian Statistics
### Øystein Sørensen
### Department of Psychology, University of Oslo
### 2021/11/02

---







---

class: inverse, middle, center

# Part II - Bayesian Workflow for Data Analysis



---

# Bayesian Workflow?

Gelman et al. (2021) write

&gt; Using Bayesian inference to solve real-world problems requires not only statistical skills, subject matter knowledge, and programming, but also awareness of the decisions made in the process of data analysis. All of these aspects can be understood as part of a tangled workflow of applied Bayesian statistics.

.footnote[Gelman, A., Vehtari, A., Simpson, D., Margossian, C. C., Carpenter, B., Yao, Y., Kennedy, L., Gabry, J., Bürkner, P.-C., &amp; Modrák, M. (2020). Bayesian Workflow. ArXiv:2011.01808 [Stat]. http://arxiv.org/abs/2011.01808]


---

# Phases of a Statistical Workflow

(a) Exploratory data analysis to aid in choosing initial model.

(b) Quantify prior knowledge.

(c) Check that the computations work correctly.

(d) Check that the model fits the data well.

(e) Compare to other more or less complicated models.

.footnote[Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., &amp; Gelman, A. (2019). Visualization in Bayesian workflow. Journal of the Royal Statistical Society: Series A (Statistics in Society), 182(2), 389–402. https://doi.org/10.1111/rssa.12378]


---

# Birth Weight Data

Data from Low Birth Weight Study, used by Hosmer and Lemeshow (2000).



```r
dat &lt;- readRDS("data/bwt.rds")
head(dat)
```

```
## # A tibble: 6 × 5
##   Low     Age   LWT Smoker Hypertension
##   &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;  &lt;lgl&gt;       
## 1 FALSE    19  82.6 FALSE  FALSE       
## 2 FALSE    33  70.3 FALSE  FALSE       
## 3 FALSE    20  47.6 TRUE   FALSE       
## 4 FALSE    21  49.0 TRUE   FALSE       
## 5 FALSE    18  48.5 TRUE   FALSE       
## 6 FALSE    21  56.2 FALSE  FALSE
```



.footnote[David W. Hosmer and Stanley Lemeshow (2000). Applied Logistic Regression, Second Edition. John Wiley &amp; Sons, Inc. ISBN:9780471356325. https://doi.org/10.1002/0471722146]


---

# Birth Weight Data


```r
head(dat)
```

```
## # A tibble: 6 × 5
##   Low     Age   LWT Smoker Hypertension
##   &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;  &lt;lgl&gt;       
## 1 FALSE    19  82.6 FALSE  FALSE       
## 2 FALSE    33  70.3 FALSE  FALSE       
## 3 FALSE    20  47.6 TRUE   FALSE       
## 4 FALSE    21  49.0 TRUE   FALSE       
## 5 FALSE    18  48.5 TRUE   FALSE       
## 6 FALSE    21  56.2 FALSE  FALSE
```

- **Low**: Did the child have birth weight below 2500 grams?
- **Age**: Age of mother.
- **LWT**: Weight of mother at last menstrual period (kg).
- **Smoker**: Does mother smoke?
- **Hypertension**: Does mother have high blood pressure?

---

# Birth Weight Data

Research question:

- Is weight of mother at last menstrual period related to whether the child has birth weight below 2500 grams?

Possible confounding factors are age, smoking status, and hypertension.

---

# (a) Exploratory data analysis

Women with lower weight have higher probabilty of low birthweight.

&lt;img src="part-ii-workflow_files/figure-html/unnamed-chunk-6-1.svg" style="display: block; margin: auto;" /&gt;


---

# (a) Exploratory data analysis

.pull-left[
Weaker relationship when stratifying by smoking status?

&lt;img src="part-ii-workflow_files/figure-html/unnamed-chunk-7-1.svg" style="display: block; margin: auto;" /&gt;
]
--
.pull-right[

Reasonable numbers in each group:


```r
dat %&gt;% 
  group_by(Low, Smoker) %&gt;% 
  count()
```

```
## # A tibble: 4 × 3
## # Groups:   Low, Smoker [4]
##   Low   Smoker     n
##   &lt;lgl&gt; &lt;lgl&gt;  &lt;int&gt;
## 1 FALSE FALSE     86
## 2 FALSE TRUE      44
## 3 TRUE  FALSE     29
## 4 TRUE  TRUE      30
```

]

---

# (a) Exploratory data analysis


.pull-left[
What about hypertension?

&lt;img src="part-ii-workflow_files/figure-html/unnamed-chunk-9-1.svg" style="display: block; margin: auto;" /&gt;
]
--
.pull-right[

Small group sizes, so we should take the plots with a grain of salt.


```r
dat %&gt;% 
  group_by(Low, Hypertension) %&gt;% 
  count()
```

```
## # A tibble: 4 × 3
## # Groups:   Low, Hypertension [4]
##   Low   Hypertension     n
##   &lt;lgl&gt; &lt;lgl&gt;        &lt;int&gt;
## 1 FALSE FALSE          125
## 2 FALSE TRUE             5
## 3 TRUE  FALSE           52
## 4 TRUE  TRUE             7
```

]

---

# (a) Exploratory data analysis

Hard to claim that there is a relationship between age and low birthweight:

&lt;img src="part-ii-workflow_files/figure-html/unnamed-chunk-11-1.svg" style="display: block; margin: auto;" /&gt;

---

# (a) Exploratory data analysis

Logistic regression model seems appropriate.

- Initial model of the form 

`Low ~ LWT`

- We believe that smoking status might be an important covariate to include.

- Will also include age, so the most complex model becomes:

`Low ~ LWT + Age + Smoker`.


---

# (b) Quantify prior knowledge

Prior predictive simulations:

- Giving values to the parameters of the prior distribution is hard. We can circumvent the problem by rather looking at what type of data are implied by the prior.


---

# (b) Quantify prior knowledge

Consider simplest logistic regression model

`$$P(Low) = \text{logit}\left(\beta_{0} + \beta_{LWT} LWT\right)$$`

Sample parameters from the prior and then sample data given the parameters.


---

class: center, middle

# Thanks!

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](https://yihui.org/knitr/), and [R Markdown](https://rmarkdown.rstudio.com).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
